<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>PyScript Full Debug Toolkit</title>
  <link rel="stylesheet" href="https://pyscript.net/releases/2024.11.1/core.css" />
  <script type="module" src="https://pyscript.net/releases/2024.11.1/core.js"></script>
  <style>
    .box { padding: 10px; background: #f9f9f9; margin: 10px 0; border-left: 4px solid #ccc; }
    .success { color: green; }
    .error { color: red; }
  </style>
</head>
<body>

<h1>üß™ PyScript Full Debugging Toolkit</h1>

<h2>‚úÖ PyScript Version</h2>
<div id="version-output" class="box"></div>

<h2>‚úÖ print() Output</h2>
<div id="print-output" class="box"></div>

<h2>‚úÖ display() Output</h2>
<div id="display-output" class="box"></div>

<h2>‚úÖ JS ‚Üí Python Communication</h2>
<button onclick="sendToPython()">Send Message to Python</button>
<div id="js-to-py-output" class="box"></div>

<h2>‚úÖ Python ‚Üí JS Console Logs</h2>
<p>Check your browser's console (DevTools > Console tab)</p>

<h2>‚úÖ Runtime Python Execution</h2>
<button id="run-btn" disabled>Run dynamic Python</button>
<div id="dynamic-output" class="box"></div>

<hr>

<py-script output="print-output">
try:
    import js
    from js import console, document
    import sys
    from pyscript import display
    from pyodide.ffi import create_proxy

    print("‚úÖ print() is working")
    console.log("‚úÖ Python log to console")

    display("‚úÖ display() is working", target="display-output")
    document.getElementById("version-output").innerText = f"Python version: {sys.version}"

    # JS ‚Üí Python test
    def receive_from_js(msg):
        display(f"‚úÖ Received from JS: {msg}", target="js-to-py-output")
    js.receive_from_js = create_proxy(receive_from_js)

    # Enable dynamic run button
    js.document.getElementById("run-btn").disabled = False
except Exception as e:
    print("‚ùå Exception caught:", e)
    console.error("‚ùå Python error:", e)
</py-script>

<noscript>
  <p class="error">‚ùå JavaScript is disabled or blocked.</p>
</noscript>

<script>
  function sendToPython() {
    if (window.receive_from_js) {
      window.receive_from_js("Hello from JS!")
    } else {
      document.getElementById("js-to-py-output").innerText = "‚ùå Python handler not ready"
    }
  }

  document.getElementById("run-btn").addEventListener("click", () => {
    if (window.pyscript?.runPythonAsync) {
      pyscript.runPythonAsync(`
from pyscript import display
display("‚úÖ This was dynamically injected from JS!", target="dynamic-output")
`)
    } else {
      document.getElementById("dynamic-output").innerText = "‚ùå PyScript not ready yet."
    }
  })
</script>

</body>
</html>
